{"version":3,"file":"reactivity.global.js","sources":["../../shared/src/index.ts","../src/effect.ts","../src/reactive.ts","../src/computed.ts","../src/ref.ts"],"sourcesContent":["export function isObject(value) {\n  return typeof value === 'object' && value !== null\n}\n\nexport function isFunction(value) {\n  return typeof value === 'function'\n}\n\nexport function isString(value) {\n  return typeof value === 'string'\n}\n\n// 通过 ShapeFlags[...] & component 校验组件类型\nexport const enum ShapeFlags {\n  ELEMENT = 1, // 元素\n  FUNCTIONAL_COMPONENT = 1 << 1, // 函数式组件\n  STATEFUL_COMPONENT = 1 << 2, // 普通组件\n  TEXT_CHILDREN = 1 << 3, // 孩子是文本\n  ARRAY_CHILDREN = 1 << 4, // 孩子是数组\n  SLOTS_CHILDREN = 1 << 5, // 组件插槽\n  TELEPORT = 1 << 6, // teleport组件\n  SUSPENSE = 1 << 7, // suspense组件\n  COMPONENT = ShapeFlags.STATEFUL_COMPONENT | ShapeFlags.FUNCTIONAL_COMPONENT \t// 组件\n}\n\nexport const hasOwn = (value,key) => Object.prototype.hasOwnProperty.call(value,key);","// effectStack作用：\n// 1.配合 activedEffect 解决 effect 内部嵌套 effect 时收集的依赖属性属于哪个effect的问题\n// 2.记录当前effect实例，避免 fn 内赋值时触发 setter 重复执行 run()导致死循环\nconst effectStack = []\nexport let activedEffect\nexport class ReactiveEffect {\n  active = true // 当前 effect 实例有用（有依赖项）\n  deps = [] // 记录当前 effect实例依赖的 响应属性 收集的 effect数组，用于取消当前effect的响应式调用\n  constructor(public fn, public scheduler?) { // ts会将 public 编译为 this.fn = fn\n    \n  }\n  run() {\n    if (!this.active) return this.fn // 虽然当前effect失活了，但调用 run 时依然要执行 fn\n    if (!effectStack.includes(this)) { // 避免 fn 内赋值时触发 setter 重复执行 run()导致死循环\n      try {\n        effectStack.push(activedEffect = this)\n        return this.fn() // 触发用到的响应属性的 getter，执行 track()收集当前effect实例\n      } finally { // 解决 effect 内部嵌套 effect 时收集的依赖属性属于哪个effect的问题\n        effectStack.pop()\n        activedEffect = effectStack[effectStack.length - 1]\n      }\n    }\n  }\n  stop() {\n    if (this.active) {\n      for (const dep of this.deps) {\n        dep.delete(this)\n      }\n      this.active = false\n    }\n  }\n}\n\nconst targetMap = new WeakMap() // 响应属性收集的依赖集合：{ target1: { key1: [effect, ...], key2... }, target2... }\nexport function track(target, key) {\n  if (!activedEffect) return // 没有 effect不收集\n  let depsMap = targetMap.get(target)\n  if (!depsMap) {\n    targetMap.set(target, depsMap = new Map())\n  }\n  let dep = depsMap.get(key)\n  if (!dep) {\n    depsMap.set(key, dep = new Set())\n  }\n  trackEffects(dep)\n}\n\nexport function trackEffects(dep) {\n  if (!dep.has(activedEffect)) {\n    dep.add(activedEffect) // 收集当前 effect实例\n    activedEffect.deps.push(dep) // 互相记录\n  }\n}\n\nexport function trigger(target, key) {\n  const depsMap = targetMap.get(target)\n  if (!depsMap) return\n  if (key !== undefined) {\n    const dep = depsMap.get(key)\n    triggerEffects(dep)\n  }\n}\n\nexport function triggerEffects(dep) {\n  for (const effect of dep) {\n    if (effect !== activedEffect) // 赋值可能发生在 effect内，注意不能重复执行\n      if (effect.scheduler) { // 为实现计算属性响应更新的功能：以手动执行计算属性中收集的其他 effect\n        return effect.scheduler()\n      }\n      effect.run()\n  }\n}\n\nexport function effect(fn) {\n  const _effect = new ReactiveEffect(fn)\n  _effect.run()\n  // 处理 强制执行effect（runner()）和注销effect（runner.effect.stop()）的情况\n  const runner = _effect.run.bind(_effect)\n  runner.effect = _effect\n  return runner\n}","import { isObject } from \"@vue/shared\";\nimport { track, trigger } from \"./effect\";\n\nexport const enum ReactiveFlags {\n  SKIP = '__v_skip',\n  IS_REACTIVE = '__v_isReactive',\n  IS_READONLY = '__v_isReadonly',\n  IS_SHALLOW = '__v_isShallow',\n  RAW = '__v_raw'\n}\n\nfunction createGetter(isReadonly = false, shallow = false) {\n  return function get(target, key, receiver) {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return !isReadonly\n    } else if (key === ReactiveFlags.IS_READONLY) {\n      return isReadonly\n    } else if (key === ReactiveFlags.IS_SHALLOW) {\n      return shallow\n    } else if ( // 将被代理对象转为原始对象条件\n      key === ReactiveFlags.RAW &&\n      receiver ===\n        (isReadonly\n          ? shallow\n            ? shallowReadonlyMap\n            : readonlyMap\n          : shallow\n            ? shallowReactiveMap\n            : reactiveMap\n        ).get(target)\n    ) {\n      return target\n    }\n    const res = Reflect.get(target, key, receiver)\n\n    if (!isReadonly) {\n      track(target, key) // 依赖收集\n    }\n    if (shallow) {\n      return res // shallow 不递归代理嵌套对象\n    }\n    if (isObject(res)) {\n      // 读取嵌套对象时递归收集依赖：Convert returned value into a proxy as well. we do the isObject check\n      // here to avoid invalid value warning. Also need to lazy access readonly\n      // and reactive here to avoid circular dependency.\n      return isReadonly ? readonly(res) : reactive(res)\n    }\n    return res\n  }\n}\n\nfunction createSetter() {\n  return function set(target, key, value, receiver) {\n    const oldValue = target[key]\n    const result = Reflect.set(target, key, value, receiver)\n    if (oldValue !== value) trigger(target, key) // 依赖触发\n    return result\n  }\n}\n\nconst get = createGetter()\nconst shallowGet = createGetter(false, true)\nconst readonlyGet = createGetter(true)\nconst shallowReadonlyGet = createGetter(true, true)\nconst set = createSetter()\n\nexport const mutableHandlers = { get, set }\n// in shallow mode, objects are set as-is regardless of reactive or not\nexport const shallowReactiveHandlers = Object.assign( {}, mutableHandlers, { get: shallowGet } )\nexport const readonlyHandlers = {\n  get: readonlyGet,\n  set(target, key) {\n    return true\n  },\n  deleteProperty(target, key) {\n    return true\n  }\n}\nexport const shallowReadonlyHandlers = Object.assign( {}, readonlyHandlers, { get: shallowReadonlyGet } )\n\nconst reactiveMap = new WeakMap()\nconst shallowReactiveMap = new WeakMap()\nconst readonlyMap = new WeakMap()\nconst shallowReadonlyMap = new WeakMap()\n\nfunction createReactiveObject(target, isReadonly, baseHandlers, proxyMap) {\n  if (!isObject(target)) return target\n  // target is already a Proxy, return it.代理已经被代理过的对象 直接返回（原理：被代理后 target[ReactiveFlags.RAW] 将返回原始对象，为 true）\n  // exception: calling readonly() on a reactive object\n  if (target[ReactiveFlags.RAW] && !(isReadonly && target[ReactiveFlags.IS_REACTIVE])) {\n    return target\n  }\n\n  const existingProxy = proxyMap.get(target) // 解决重复代理同一对象问题（原理：使用 WeakMap 缓存）\n  if (existingProxy) return existingProxy\n\n  const proxy = new Proxy(target, baseHandlers)\n  proxyMap.set(target, proxy) // 缓存\n  return proxy\n}\n\nexport function reactive(target) {\n  return createReactiveObject(target, false, mutableHandlers, reactiveMap)\n}\nexport function shallowReactive(target) {\n  return createReactiveObject(target, false, shallowReactiveHandlers, shallowReactiveMap)\n}\nexport function readonly(target) {\n  return createReactiveObject(target, true, readonlyHandlers, readonlyMap)\n}\nexport function shallowReadonly(target) {\n  return createReactiveObject(target, true, shallowReadonlyHandlers, shallowReadonlyMap)\n}\n\n// 获取被代理对象的原始对象\nexport function toRaw(observed) {\n  const raw = observed && observed[ReactiveFlags.RAW]\n  return raw ? toRaw(raw) : observed\n}\nexport const toReactive = value =>\n  isObject(value) ? reactive(value) : value\n// 标记对象不可被代理\nexport function markRaw(value) {\n  Object.defineProperty(value, ReactiveFlags.SKIP, {\n    configurable: true,\n    enumerable: false,\n    value\n  })\n  return value\n}\n","import { isFunction } from \"@vue/shared\";\nimport { ReactiveEffect, activedEffect, trackEffects, triggerEffects } from \"./effect\";\n\nclass ComputedRefImpl {\n  public dep // 引用了当前计算属性的 effect\n  private _value // 计算属性的值\n  public _dirty = true // 缓存控制开关\n  // 计算属性要根据用到的响应属性自动更新，就要内置自己的 effect来让响应属性收集到依赖列表中（作为观察者订阅更新）\n  public readonly effect\n  public readonly __v_isRef = true\n\n  constructor(getter, private readonly _setter) {\n    // getter中的响应属性变更时，trigger()中如果“按部就班”执行 effect（即执行getter）并不会响应式地执行 this.dep中的依赖，\n    // 所以要加入第二个参数 scheduler函数以手动执行收集的 effect\n    this.effect = new ReactiveEffect(getter, () => {\n      this._dirty = true\n      triggerEffects(this.dep)\n    })\n  }\n  // 类的属性访问器，底层为 defineProperty\n  get value() { // 读取计算属性的value时会执行此函数，收集依赖、更新值 ⬇︎\n    if (activedEffect) { // 计算属性如果是在其他 effect中被读取，要收集那些 effect，以便将来响应更新\n      trackEffects(this.dep || (this.dep = new Set()))\n    }\n    if (this._dirty) {\n      this._value = this.effect.run() // 触发 getter中的响应属性从而收集this.effect\n      this._dirty = false // 缓存，避免多次取值时（getter中的响应属性不变的情况下）多次无意义地重新执行getter\n    }\n    return this._value\n  }\n  set value(newValue) {\n    this._setter(newValue)\n  }\n}\n\nexport function computed(getterOrOptions) {\n  let getter, setter\n  const onlyGetter = isFunction(getterOrOptions)\n  if (onlyGetter) {\n    getter = getterOrOptions\n    setter = () => {}\n  } else {\n    getter = getterOrOptions.get\n    setter = getterOrOptions.set\n  }\n  return new ComputedRefImpl(getter, setter)\n}","import { toReactive } from \"./reactive\";\nimport { activedEffect, trackEffects, triggerEffects } from \"./effect\";\n\nclass RefImp {\n  public dep // 引用了当前ref的 effect\n  private _value // ref的值\n  public readonly __v_isRef = true // 处理 已经添加过响应的值 直接返回（原理：createRef中 value.__v_isRef 返回 true）\n  \n  constructor(private _rawValue, public readonly __v_isShallow) {\n    this._value = __v_isShallow ? _rawValue : toReactive(_rawValue) // 如果是对象要转为reactive\n  }\n  get value() {\n    if (activedEffect) { // 如果是在其他 effect中被读取，要收集那些 effect，以便将来响应更新\n      trackEffects(this.dep || (this.dep = new Set()))\n    }\n    return this._value\n  }\n  set value(newVal) {\n    const useDirectValue = this.__v_isShallow || newVal.__v_isShallow || newVal.__v_isReadonly\n    if (newVal !== this._rawValue) {\n      this._rawValue = newVal\n      this._value = useDirectValue ? newVal : toReactive(newVal)\n      triggerEffects(this.dep)\n    }\n  }\n}\n\nfunction createRef(value, shallow) {\n  if (isRef(value)) {\n    return value\n  }\n  return new RefImp(value, shallow)\n}\n\nexport function ref(value) {\n  return createRef(value, false)\n}\n\nexport function shallowRef(value?: unknown) {\n  return createRef(value, true)\n}\n\nexport function unref(ref) {\n  return isRef(ref) ? ref.value : ref\n}\n\nexport function isRef(r) {\n  return !!(r && r.__v_isRef === true)\n}\n"],"names":[],"mappings":"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"}