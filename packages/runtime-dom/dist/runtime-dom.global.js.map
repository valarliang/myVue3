{"version":3,"file":"runtime-dom.global.js","sources":["../src/nodeOps.ts","../src/patchProp.ts","../../shared/src/index.ts","../../reactivity/src/effect.ts","../../reactivity/src/reactive.ts","../../reactivity/src/computed.ts","../../reactivity/src/ref.ts","../src/index.ts"],"sourcesContent":["export const nodeOps = {\r\n    insert: (child, parent, anchor = null) => { // 插入有追加的功能\r\n        parent.insertBefore(child, anchor); // parent.appendChild(child)\r\n    },\r\n    remove: child => {\r\n        const parent = child.parentNode;\r\n        if (parent) {\r\n            parent.removeChild(child);\r\n        }\r\n    },\r\n    createElement: tag => document.createElement(tag),\r\n    createText: text => document.createTextNode(text),\r\n    setElementText: (el, text) => el.textContent = text,\r\n    setText: (node, text) => node.nodeValue = text,\r\n    parentNode: node => node.parentNode,\r\n    nextSibling: node => node.nextSibling,\r\n    querySelector: selector => document.querySelector(selector)\r\n}\r\n\r\n\r\n// runtime-dom 提供 节点操作的api -> 传递给 runtime-core ","\r\n\r\n// 需要比对属性 diff算法    属性比对前后值\r\nfunction patchClass(el, value) {\r\n    if (value == null) {\r\n        el.removeAttribute('class');\r\n    } else {\r\n        el.className = value;\r\n    }\r\n}\r\nfunction patchStyle(el, prev, next) {\r\n    const style = el.style; // 操作的是样式\r\n    // 最新的肯定要全部加到元素上\r\n    for (let key in next) {\r\n        style[key] = next[key];\r\n    }\r\n    // 新的没有 但是老的有这个属性, 将老的移除掉\r\n    if (prev) {\r\n        for (let key in prev) {\r\n            if (next[key] == null) {\r\n                style[key] = null;\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction createInvoker(value) {\r\n    const invoker = (e) => { // 每次事件触发调用的都是invoker \r\n        invoker.value(e)\r\n    }\r\n    invoker.value = value; // 存储这个变量, 后续想换绑 可以直接更新value值\r\n    return invoker\r\n}\r\nfunction patchEvent(el, key, nextValue) {\r\n    // vei  vue event invoker  缓存绑定的事件 \r\n    const invokers = el._vei || (el._vei = {}); // 在元素上绑定一个自定义属性 用来记录绑定的事件\r\n    let exisitingInvoker = invokers[key]; // 先看一下有没有绑定过这个事件\r\n    if (exisitingInvoker && nextValue) { // 换绑逻辑\r\n        exisitingInvoker.value = nextValue\r\n    } else {\r\n        const name = key.slice(2).toLowerCase(); // eventName\r\n        if (nextValue) {\r\n            const invoker = invokers[key] = createInvoker(nextValue); // 返回一个引用\r\n            el.addEventListener(name, invoker);  // 正规的时间 onClick =(e)=>{}\r\n        } else if (exisitingInvoker) {\r\n            // 如果下一个值没有 需要删除\r\n            el.removeEventListener(name, exisitingInvoker);\r\n            invokers[key] = undefined; // 解绑了\r\n        }\r\n        // else{\r\n        //     // 压根没有绑定过 事件就不需要删除了\r\n        // }\r\n    }\r\n}\r\nfunction patchAttr(el, key, value) {\r\n    if (value == null) {\r\n        el.removeAttribute(key)\r\n    } else {\r\n        el.setAttribute(key, value)\r\n    }\r\n}\r\nexport const patchProp = (el, key, prevValue, nextValue) => {\r\n    if (key === 'class') { // 类名 \r\n        patchClass(el, nextValue); // \r\n    } else if (key === 'style') { // 样式\r\n        patchStyle(el, prevValue, nextValue);\r\n    } else if (/^on[^a-z]/.test(key)) { // onXxx\r\n        // 如果有事件 addEventListener  如果没事件 应该用removeListener\r\n        patchEvent(el, key, nextValue);\r\n        // 绑定一个 换帮了一个  在换绑一个\r\n    } else {\r\n        // 其他属性 setAttribute\r\n        patchAttr(el, key, nextValue);\r\n    }\r\n}","export function isObject(value) {\n  return typeof value === 'object' && value !== null\n}\n\nexport function isFunction(value) {\n  return typeof value === 'function'\n}","// effectStack作用：\n// 1.配合 activedEffect 解决 effect 内部嵌套 effect 时收集的依赖属性属于哪个effect的问题\n// 2.记录当前effect实例，避免 fn 内赋值时触发 setter 重复执行 run()导致死循环\nconst effectStack = []\nexport let activedEffect\nexport class ReactiveEffect {\n  active = true // 当前 effect 实例有用（有依赖项）\n  deps = [] // 记录当前 effect实例依赖的 响应属性 收集的 effect数组，用于取消当前effect的响应式调用\n  constructor(public fn, public scheduler?) { // ts会将 public 编译为 this.fn = fn\n    \n  }\n  run() {\n    if (!this.active) return this.fn // 虽然当前effect失活了，但调用 run 时依然要执行 fn\n    if (!effectStack.includes(this)) { // 避免 fn 内赋值时触发 setter 重复执行 run()导致死循环\n      try {\n        effectStack.push(activedEffect = this)\n        return this.fn() // 触发用到的响应属性的 getter，执行 track()收集当前effect实例\n      } finally { // 解决 effect 内部嵌套 effect 时收集的依赖属性属于哪个effect的问题\n        effectStack.pop()\n        activedEffect = effectStack[effectStack.length - 1]\n      }\n    }\n  }\n  stop() {\n    if (this.active) {\n      for (const dep of this.deps) {\n        dep.delete(this)\n      }\n      this.active = false\n    }\n  }\n}\n\nconst targetMap = new WeakMap() // 响应属性收集的依赖集合：{ target1: { key1: [effect, ...], key2... }, target2... }\nexport function track(target, key) {\n  if (!activedEffect) return // 没有 effect不收集\n  let depsMap = targetMap.get(target)\n  if (!depsMap) {\n    targetMap.set(target, depsMap = new Map())\n  }\n  let dep = depsMap.get(key)\n  if (!dep) {\n    depsMap.set(key, dep = new Set())\n  }\n  trackEffects(dep)\n}\n\nexport function trackEffects(dep) {\n  if (!dep.has(activedEffect)) {\n    dep.add(activedEffect) // 收集当前 effect实例\n    activedEffect.deps.push(dep) // 互相记录\n  }\n}\n\nexport function trigger(target, key) {\n  const depsMap = targetMap.get(target)\n  if (!depsMap) return\n  if (key !== undefined) {\n    const dep = depsMap.get(key)\n    triggerEffects(dep)\n  }\n}\n\nexport function triggerEffects(dep) {\n  for (const effect of dep) {\n    if (effect !== activedEffect) // 赋值可能发生在 effect内，注意不能重复执行\n      if (effect.scheduler) { // 为实现计算属性响应更新的功能：以手动执行计算属性中收集的其他 effect\n        return effect.scheduler()\n      }\n      effect.run()\n  }\n}\n\nexport function effect(fn) {\n  const _effect = new ReactiveEffect(fn)\n  _effect.run()\n  // 处理 强制执行effect（runner()）和注销effect（runner.effect.stop()）的情况\n  const runner = _effect.run.bind(_effect)\n  runner.effect = _effect\n  return runner\n}","import { isObject } from \"@vue/shared\";\nimport { track, trigger } from \"./effect\";\n\nexport const enum ReactiveFlags {\n  SKIP = '__v_skip',\n  IS_REACTIVE = '__v_isReactive',\n  IS_READONLY = '__v_isReadonly',\n  IS_SHALLOW = '__v_isShallow',\n  RAW = '__v_raw'\n}\n\nfunction createGetter(isReadonly = false, shallow = false) {\n  return function get(target, key, receiver) {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return !isReadonly\n    } else if (key === ReactiveFlags.IS_READONLY) {\n      return isReadonly\n    } else if (key === ReactiveFlags.IS_SHALLOW) {\n      return shallow\n    } else if ( // 将被代理对象转为原始对象条件\n      key === ReactiveFlags.RAW &&\n      receiver ===\n        (isReadonly\n          ? shallow\n            ? shallowReadonlyMap\n            : readonlyMap\n          : shallow\n            ? shallowReactiveMap\n            : reactiveMap\n        ).get(target)\n    ) {\n      return target\n    }\n    const res = Reflect.get(target, key, receiver)\n\n    if (!isReadonly) {\n      track(target, key) // 依赖收集\n    }\n    if (shallow) {\n      return res // shallow 不递归代理嵌套对象\n    }\n    if (isObject(res)) {\n      // 读取嵌套对象时递归收集依赖：Convert returned value into a proxy as well. we do the isObject check\n      // here to avoid invalid value warning. Also need to lazy access readonly\n      // and reactive here to avoid circular dependency.\n      return isReadonly ? readonly(res) : reactive(res)\n    }\n    return res\n  }\n}\n\nfunction createSetter() {\n  return function set(target, key, value, receiver) {\n    const oldValue = target[key]\n    const result = Reflect.set(target, key, value, receiver)\n    if (oldValue !== value) trigger(target, key)\n    return result\n  }\n}\n\nconst get = createGetter()\nconst shallowGet = createGetter(false, true)\nconst readonlyGet = createGetter(true)\nconst shallowReadonlyGet = createGetter(true, true)\nconst set = createSetter()\n\nexport const mutableHandlers = { get, set }\n// in shallow mode, objects are set as-is regardless of reactive or not\nexport const shallowReactiveHandlers = Object.assign( {}, mutableHandlers, { get: shallowGet } )\nexport const readonlyHandlers = {\n  get: readonlyGet,\n  set(target, key) {\n    return true\n  },\n  deleteProperty(target, key) {\n    return true\n  }\n}\nexport const shallowReadonlyHandlers = Object.assign( {}, readonlyHandlers, { get: shallowReadonlyGet } )\n\nconst reactiveMap = new WeakMap()\nconst shallowReactiveMap = new WeakMap()\nconst readonlyMap = new WeakMap()\nconst shallowReadonlyMap = new WeakMap()\n\nfunction createReactiveObject(target, isReadonly, baseHandlers, proxyMap) {\n  if (!isObject(target)) return target\n  // target is already a Proxy, return it.\n  // exception: calling readonly() on a reactive object\n  // 代理 已经被代理过的对象 直接返回（原理：被代理后 target[ReactiveFlags.RAW] 将返回原始对象，为 true）\n  if (target[ReactiveFlags.RAW] && !(isReadonly && target[ReactiveFlags.IS_REACTIVE])) {\n    return target\n  }\n\n  const existingProxy = proxyMap.get(target) // 解决重复代理同一对象问题（原理：使用 WeakMap 缓存）\n  if (existingProxy) return existingProxy\n\n  const proxy = new Proxy(target, baseHandlers)\n  proxyMap.set(target, proxy)\n  return proxy\n}\n\nexport function reactive(target) {\n  return createReactiveObject(target, false, mutableHandlers, reactiveMap)\n}\nexport function shallowReactive(target) {\n  return createReactiveObject(target, false, shallowReactiveHandlers, shallowReactiveMap)\n}\nexport function readonly(target) {\n  return createReactiveObject(target, true, readonlyHandlers, readonlyMap)\n}\nexport function shallowReadonly(target) {\n  return createReactiveObject(target, true, shallowReadonlyHandlers, shallowReadonlyMap)\n}\n\n// 获取被代理对象的原始对象\nexport function toRaw(observed) {\n  const raw = observed && observed[ReactiveFlags.RAW]\n  return raw ? toRaw(raw) : observed\n}\nexport const toReactive = value =>\n  isObject(value) ? reactive(value) : value\n// 标记对象不可被代理\nexport function markRaw(value) {\n  Object.defineProperty(value, ReactiveFlags.SKIP, {\n    configurable: true,\n    enumerable: false,\n    value\n  })\n  return value\n}\n","import { isFunction } from \"@vue/shared\";\nimport { ReactiveEffect, activedEffect, trackEffects, triggerEffects } from \"./effect\";\n\nclass ComputedRefImpl {\n  public dep // 引用了当前计算属性的 effect\n  private _value // 计算属性的值\n  public _dirty = true // 缓存控制开关\n  // 计算属性要根据用到的响应属性自动更新，就要内置自己的 effect来让响应属性收集到依赖列表中（作为观察者订阅更新）\n  public readonly effect\n  public readonly __v_isRef = true\n\n  constructor(getter, private readonly _setter) {\n    // getter中的响应属性变更时，trigger()中如果“按部就班”执行 effect（即执行getter）并不会响应式地执行 this.dep中的依赖，\n    // 所以要加入第二个参数 scheduler函数以手动执行收集的 effect\n    this.effect = new ReactiveEffect(getter, () => {\n      this._dirty = true\n      triggerEffects(this.dep)\n    })\n  }\n  // 类的属性访问器，底层为 defineProperty\n  get value() { // 读取计算属性的value时会执行此函数，收集依赖、更新值 ⬇︎\n    if (activedEffect) { // 计算属性如果是在其他 effect中被读取，要收集那些 effect，以便将来响应更新\n      trackEffects(this.dep || (this.dep = new Set()))\n    }\n    if (this._dirty) {\n      this._value = this.effect.run() // 触发 getter中的响应属性从而收集this.effect\n      this._dirty = false // 缓存，避免多次取值时（getter中的响应属性不变的情况下）多次无意义地重新执行getter\n    }\n    return this._value\n  }\n  set value(newValue) {\n    this._setter(newValue)\n  }\n}\n\nexport function computed(getterOrOptions) {\n  let getter, setter\n  const onlyGetter = isFunction(getterOrOptions)\n  if (onlyGetter) {\n    getter = getterOrOptions\n    setter = () => {}\n  } else {\n    getter = getterOrOptions.get\n    setter = getterOrOptions.set\n  }\n  return new ComputedRefImpl(getter, setter)\n}","import { toReactive } from \"./reactive\";\nimport { activedEffect, trackEffects, triggerEffects } from \"./effect\";\n\nclass RefImp {\n  public dep // 引用了当前ref的 effect\n  private _value // ref的值\n  public readonly __v_isRef = true // 处理 已经添加过响应的值 直接返回（原理：createRef中 value.__v_isRef 返回 true）\n  \n  constructor(private _rawValue, public readonly __v_isShallow) {\n    this._value = __v_isShallow ? _rawValue : toReactive(_rawValue) // 如果是对象要转为reactive\n  }\n  get value() {\n    if (activedEffect) { // 如果是在其他 effect中被读取，要收集那些 effect，以便将来响应更新\n      trackEffects(this.dep || (this.dep = new Set()))\n    }\n    return this._value\n  }\n  set value(newVal) {\n    const useDirectValue = this.__v_isShallow || newVal.__v_isShallow || newVal.__v_isReadonly\n    if (newVal !== this._rawValue) {\n      this._rawValue = newVal\n      this._value = useDirectValue ? newVal : toReactive(newVal)\n      triggerEffects(this.dep)\n    }\n  }\n}\n\nfunction createRef(value, shallow) {\n  if (isRef(value)) {\n    return value\n  }\n  return new RefImp(value, shallow)\n}\n\nexport function ref(value) {\n  return createRef(value, false)\n}\n\nexport function shallowRef(value?: unknown) {\n  return createRef(value, true)\n}\n\nexport function unref(ref) {\n  return isRef(ref) ? ref.value : ref\n}\n\nexport function isRef(r) {\n  return !!(r && r.__v_isRef === true)\n}\n","import { nodeOps } from './nodeOps'\nimport { patchProp } from \"./patchProp\";\n\nconst reanderOptions = Object.assign(nodeOps, { patchProp })\n\nexport * from '@vue/runtime-core'"],"names":[],"mappings":"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"}